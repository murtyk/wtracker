<h1><%= "Trainees Near - #{@employer_map.employers[0].name}" %></h1>
<h4>Found: <%= @employer_map.trainees.count %></h4>

<div class='row-fluid'>
  <div class='span9'>
    <table id="table_trainees" class="table table-condensed table-bordered table-striped table-hover">
      <tr>
        <th>Name</th>
        <th>Class</th>
        <th>Email</th>
      </tr>
      <% @employer_map.trainees.each do |trainee| %>
        <tr>
          <td><%= trainee.name %></td>
          <td><%= trainee.klasses.map{ |k| k.name}.join('<br>').html_safe %></td>
          <td><%= trainee.email %></td>
        </tr>
      <% end %>
    </table>
  </div>
  <% if @employer_map.trainees.any? %>
  <div class='span3' style='background-color: #eee; padding:10px'>
    <b>Send Email:</b><hr>
    <%= simple_form_for @trainee_email do |f| %>
      <%= f.hidden_field :klass_id %>
      <%= f.hidden_field :trainee_ids %>
      <%= f.input :subject, input_html: { style: 'width: 90%'} %>
      <%= f.input :content, input_html: { style: 'width: 90%; height: 100px'} %>
      <%= submit_button(f, 'Send') %>
    <% end %>
  </div>
  <% end %>
</div>
<div class='row-fluid'>
  <%= gmaps(@employer_map.map) if @employer_map.map %>
</div>
<script type="text/javascript">
  $('.new_trainee_email').submit(function() {
    subject = $('#trainee_email_subject').val();
    if (subject.length < 5){
      alert('subject should be minimum 5 characters');
      return false;
    }
    content = $('#trainee_email_content').val();
    if (content.length < 5){
      alert('content should be minimum 5 characters');
      return false;
    }
  });
</script>
