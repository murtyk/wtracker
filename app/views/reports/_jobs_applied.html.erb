<table id="data-table" class="table table-condensed table-bordered table-striped table-hover">
  <tr style="display:none;">
    <th><%= @report.title %></th>
    <%= 4.times.map{'<th></th>'}.join().html_safe %>
  </tr>

  <tr>
    <th>Name</th>
    <th>Class</th>
    <th>Applied On</th>
    <th>Employer</th>
    <th>Title</th>
  </tr>

  <% report.trainees.each do |trainee| %>
    <tr>
      <td><%= link_to(trainee.name, trainee) %></td>
      <td>
          <% trainee.klasses.each do |klass| %>
            <p><%= policy(klass).show? ? link_to(klass.to_label, klass) : klass.to_label %></p>
          <% end %>
      </td>
      <% applied_dates = employers = titles = ""%>
      <% trainee.trainee_submits.each do |job_applied| %>
        <% applied_dates += "<p>#{job_applied.applied_on ? job_applied.applied_on.to_s : ""}</p>" %>
        <% employers += "<p>#{link_to job_applied.employer.name, job_applied.employer}</p>" %>
        <% titles += "<p>#{job_applied.title}</p>" %>
      <% end %>
      <td><%= applied_dates.html_safe %></td>
      <td><%= employers.html_safe %></td>
      <td><%= titles.html_safe %></td>
    </tr>
  <% end %>
</table>