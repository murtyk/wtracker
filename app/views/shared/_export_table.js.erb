<script type="text/javascript">

  function ExportTable(tblId){

    var html;
    var trhtml = "";
    var gTable = document.getElementById(tblId);
    var numofRows = gTable.rows.length;
    var numofCells =  gTable.rows[0].cells.length;

    for ( r = 0; r < numofRows; r++)
    {
      var c =0;
      var tdhtml =  "" ;
      var node;

      for (c = 0; c < numofCells; c++)
      {
        if (gTable.rows[r].cells[c].childNodes.length == 0){
          tdhtml = tdhtml + '<td></td>';
          continue;
        }
        nodes = gTable.rows[r].cells[c].childNodes;
        cell_text = '';
        for (n = 0; n < nodes.length; n++)
        {
          cell_text = cell_text + nodes[n].textContent;
        }
        tdhtml = tdhtml + '<td>' + cell_text + '</td>';
      }
      trhtml = trhtml + "<tr>" + tdhtml + "</tr>";
    }

    html = "<table border='1'>"+trhtml+"</table>";

    // MS OFFICE 2003  : data:application/vnd.ms-excel
    window.open('data:application/vnd.ms-excel,' + encodeURIComponent(html));

    // MS OFFICE 2007  : application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
    // window.open('data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' + encodeURIComponent(html));
  }

</script>

<script type="text/javascript">

  $('#btnExport').click(function(e){
    // window.open('data:application/vnd.ms-excel,' + encodeURIComponent($('#dvData').html()));
    ExportTable("data-table");
    e.preventDefault();
  });

</script>