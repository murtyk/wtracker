<h1>Status of Job Leads</h1>
<div class = 'row-fluid filters-div'>

  <%= simple_form_for :filters, method: :get, url: url_for([:shared_job_statuses]),html: { class: 'form-search' } do |f| %>
            Class<%= f.input_field :klass_id, collection: Klass.all, id: 'select_klass', selected: params[:filters] && params[:filters][:klass_id], class: "search-query", style: 'width: 300px;' %>
            Trainee<%= f.input_field :trainee_id, collection: [], id: 'select_trainees', class: "search-query" %>
            <%= submit_button(f,"Find") %>
  <% end %>

</div>

<div class = 'row-fluid'>
  <div class = 'span10' align="center">
    <%= will_paginate @shared_job_statuses%>
  </div>
  <div class = 'span2'>
    <%= download_button if @shared_job_statuses.any? %>
  </div>
</div>

<div class = 'row-fluid'>
    <%= render 'list', shared_job_statuses: @shared_job_statuses %>
    <div class = 'row-fluid'>
      <div class = 'span10' align="center">
        <%= will_paginate @shared_job_statuses%>
      </div>
    </div>

</div>

<script type="text/javascript">

  $('#select_klass').change(function() {

    klass_id = $('#select_klass :selected').val();

    if (klass_id == "")
        {
            $('#select_trainees').html('<option value=""></option>');
        }
    else
        {

          $.ajax({
                url: "/klasses/" + klass_id + "/trainees",
                beforeSend: function(xhr, settings) {
                  xhr.setRequestHeader('accept', "text/javascript");
                  }
                });
        }
  });

  $('#select_klass').change();
  $('#select_trainee').delay(500).val(<%=params[:filters] && params[:filters][:trainee_id]%>);

</script>