# {Rails.root}/shippable.yml
# shippleable yml for CI
language: ruby

cache: true

archive: true

rvm:
  - 2.2.0

addons:
  selenium: "2.43"

env:
  - CI_REPORTS=shippable/testresults COVERAGE_REPORTS=shippable/codecoverage CAPYBARA_PAGE_PATH=shippable/capybara
  - secure: SULlcIrnDLmBrV3xC/9K0ura47H9w7qHnq4uvPuWY05lTFpNsaRiFS192z11h1yZF3kL68a77RXgpYJYgt5QI2R2gUjCTfUiGNb+Uf8/Fz8DPPQPWtNC94O6/uzifzZt2dwRCu2KL+gaDrWkAgrHXCuxUwgpGWu5yPQMkvRwCQNiC+V7Kn7VO0b55D/cYl6pr/V8rgZrdD3TFCWK4FATehA+ZLx9Yi1wPYF5hqYRiFfCNMdTSMdiGyfmYxmMYrlpSyeqyzPet7mE7yljleLTY6I6YxejpGkLST16lVs1vL2Sy5Q+NRhj4W4Ms4SW4sCgm0Cpj4JcsJ+ivP8nFZlNEq91L8/Fj/AqnOHU1pPk42EItyYRsVVf0/jLFDdGzUFlT+PzmoNNsqK+oYDcEP+Pi0ztiwptLuy4IGN1S3+G0jzUr7McldkRShDwpMoMTmStXwiMrrfRGLpr1zuw2qN2HbwoFpE85VeXX/WbSpGvgCO0kM19iLbA+vE8dBWe3baETDCsZuD08bFF4iXxC3VIj9nxUX5HoPArY2ESQQCFwYpZyQ2pu133lnbp6Mol/XUc41HfGi1t5bEcnlhB0ik39iJkzf5bW02qlXVtlcrm1Q70PnWjXABqZm5ooCEtcuCpyOakfPhiIibw8inQInlX+kSpCVvw7oWFMSIfAuOwkzqy71bxf0s4DBkPqqLbotqfyydEPj0jFWgCUsq4wo6yc1uFkZOKFwuVoiUAQng3A6C7s0ZVSHd9VZpVYDJbGC7BUs4+rsMKJglJWT0CfZshws1lh5iASgenFehzc/ERcxVSPrJODIL0EBd6D4fmYErQWBsa2JxazGJqaOvaLZgqdXPnyGgD/wuya9bqJDSeZxLRkCUjjLanYjpyQAPF/e09nipvUIVS1J9r5FfUlm2KV3oGFEt/c4uSrTs8t8zpvsSQMN5nBmb7dXemu7fjbe4SmJoEoxdKC2CalnWM7kFEukIaUx5EsEMlsEiHEg4+6/1N1HToVIefFEsduzdAWXSS

services:
 - mongodb
 - selenium

# ensure the test output and coverage dirs are created
before_script:
  - mkdir -p shippable/testresults
  - mkdir -p shippable/codecoverage
  - mkdir -p shippable/capybara
  - cp config/shippable.database.yml config/database.yml
  - psql -c 'create database wtracker_test;' -U postgres
  - RAILS_ENV=test rake db:migrate
  - RAILS_ENV=test rake testprep:load_data
  - "export DISPLAY=:99.0"
  - "/etc/init.d/xvfb start"
# write the rspec tests to the output dir
script:
  # - rspec -f JUnit -o shippable/testresults/results.xml
  - rspec --format RspecJunitFormatter -o shippable/testresults/results.xml spec/features/emails_ajax_spec.rb

notifications:
    email:
      recipients:
        - murtyk@yahoo.com